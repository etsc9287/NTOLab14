---
title: "NTOLab14"
author: "NTO"
date: "4/23/2019"
output: html_document
---

```{r,echo = FALSE,include=FALSE}

library(tidyverse)
library(lubridate)
library(stringr)
library(modelr)
options(na.action = na.warn)

babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`)

```

****
### Overall questions and Importance: 
****

* "Do mothers' smoking habits affect the presence of premature births?" and "Do mothers' smoking habits affect the correlation between their babys' gestational age and birth weight?"

* These questions are important because answering them will allow us to provide recommendations to mothers on whether or not smoking is hurtful for their newborn babies.  Most parents care deeply about the well-being of their babies, who contain fragile health, making this statistical study very relevant and important. 

****
### Team Section
****

```{r,echo = FALSE}

```

* Findings and Recommendations:

* New Tools / Comparison with Lab 4: 

****
### David's Section
****

Subquestion and Importance: Is there a coorelation between gestation and birthweight? Are ther other underlying facors that effect this coorelation?

This question is important to address because typically a premature babies are charachterized by a low gestation periods and premature babies usually weight less. If there are other factors that effect this coorelation, it can give us insight on what other variables have an effect on prematureness. 

```{r,echo = FALSE}

dave1 <- babies %>% filter(!is.na(gestation))

model1 <- function(a,data){
  a[1]+data* a[2]
    #linear model a +xb where x is data set
  # data is in form data$column
}

distance <- function(a,data){
  diff <- data - model1(a,data)
  abs(mean(diff))
    # data is in form data$column
    # finds distance
}

bwt_dist <- function(a1,a2,data){
  distance(c(a1,a2),dave1$bwtoz)
}
```

```{r,echo= FALSE}
doop <- dave1[,c(4,3)]
#best <- optim(c(0,0),distance, data = doop)
#best$par
## intial starting point in the c(0,0). finds the best slope to the data 

mod3 <- lm(bwtoz ~ gestation, data = doop)
a <- coef(mod3)
a

ggplot(data = dave1, aes(gestation,bwtoz))+
  geom_point(color = "grey15")+
 geom_abline(aes(intercept = a[1], slope = a[2]),color = "blue",size = 1.2)+ ggtitle("Birth Weight Vs. Gestation period") + ylab("Birth Weight(oz)")

#grid <- doop %>% data_grid(bwtoz)

#grid <- grid %>% add_predictions(mod3)

#ggplot(doop, aes(bwtoz)) +
 # geom_point(aes(y=gestation))+
  #geom_line( aes( y = pred),data = grid)

```

I used `lm()` to find the coeffients for the line a best fit using the model ` a[1]+data* a[2]`. The intercept and slope are shown in the tibble above. The graph shows a positive trend between gestation and birthweight. The lower the gestation period the lower the birthweight.

```{r,echo=FALSE,include=FALSE}
#dope <- doop %>% add_residuals(mod3)

#ggplot(data = dope,aes(resid))+
#  geom_freqpoly(binwidth = 1)

davie <- dave1[,c(3,4,18)] %>% filter(!is.na(smoke)) %>% mutate(smoke = str_replace_all(smoke, c("1" = "still smokes", "0" = "never")))
ggplot(davie,aes(gestation,bwtoz))+
  geom_point(aes(color = smoke))
```
****
How does a mother's smoking habits influence this coorelation??

```{r,echo=FALSE}
mod2 <- lm(bwtoz ~ gestation * smoke, data = davie)

gridtry <- davie %>% 
 data_grid(gestation,smoke) %>% 
  gather_predictions(mod2)

ggplot(davie, aes(gestation,bwtoz,colour = smoke)) + 
  geom_point() + 
  geom_line(data = gridtry, aes(y = pred),size = 1)+ggtitle("Colored by smoke habits")
```

I used the model `y ~ x1*x2` or `bwtoz ~ gestation * smoke` to see if the smoking habits along with gestation influence birthweight. I used `gather_predictions()` to plot the lines of best fit for each smoking habit. Smoking habit does have an effect on the coorelation between birthweight and gestation. The line of best fit for mothers who still smoke is significally steeper. This means that mothers who smoke have more likelyhood of a premature baby. Also of premature babies, babies with mothers that smoke weight less.

```{r,echo=FALSE}
residdiff <- davie %>% add_residuals(mod2)

ggplot(data = residdiff,aes(resid,color = smoke))+
  geom_freqpoly(binwidth = 2,size = 1)+ xlab("Residual") + ggtitle("Residual distribution in respect to best linear model")

```

I used `add_residuals()` along with my model to plot the distribution of the redisuals in respect to the best linear model. The residial distributions are centered around zero which shows that the lines of best fit are accurate. The highest residual spike for mothers who still smoke as a higher residual. This makes sense if you consider the increased slope for the previous graph.
Still smokes has more spread out residuals

****
### Ryan's Section
****

Subquestion and Importance: 

```{r,echo = FALSE}

```

New Tools: 

Findings / Relation to Team Section: 

****
### Ethan's Section
****

Subquestion and Importance: 

```{r,echo = FALSE}

```

New Tools: 

Findings / Relation to Team Section: 

****
### Arie's Section
****

Subquestion and Importance: 

```{r,echo = FALSE}

```

New Tools: 

Findings / Relation to Team Section: 

****
### Anderson's Section
****

Subquestion and Importance: 

```{r,echo = FALSE}

```

New Tools: 

Findings / Relation to Team Section: 

****
#### Who Did What
****

* David -
* Arie - 
* Anderson - 
* Ethan - 
* Ryan - 
